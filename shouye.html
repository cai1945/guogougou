<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/shouye.css">
    <title>Title</title>
</head>
<body>
    <div class="top">
        <img class="logo" src="img/1.png" alt="">
        <input type="text" >
        <span>发需求</span>
        <span>我的</span>
    </div>
    <div class="table1">
        <div class="title">抢单中心</div>
        <div class="tr2">
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
            <div><img src="img/2.png" alt=""><p>信用贷款</p></div>
        </div>
    </div>


    <div class="table2">
        <div class="box">
            <ul>
                <li class="item"><a href=""><img src="img/3.png" alt=""></a></li>
                <li class="item"><a href=""><img src="img/3.png" alt=""></a></li>
                <li class="item"><a href=""><img src="img/3.png" alt=""></a></li>
                <li class="item"><a href=""><img src="img/3.png" alt=""></a></li>
                <li class="item"><a href=""><img src="img/3.png" alt=""></a></li>
            </ul>
            <ul>
                <li class="point active"></li>
                <li class="point"></li>
                <li class="point"></li>
            </ul>
        </div>
        <div class="dianji">
            <a href="###">找顾问</a>
            <a href="###">推荐渠道</a>
        </div>
        <div class="bottom"></div>
    </div>
    <div class="table3">
        <div class="title">推荐业务 <span>更多>></span></div>
        <div class="textn">
            <div class="l ">
                <p>有150多亩土地，贷100万左右</p>
                <p><span>杨彭新185****7571</span></p>
            </div>
            <div class="r">
                <p class="kuain">
                    <a href="###" id="hong">顶</a>
                    <a href="###">荐</a>
                </p>
                <p>2016-08-15</p>
            </div>
        </div>
        <div class="textn">
            <div class="l ">
                <p>有150多亩土地，贷100万左右</p>
                <p><span>杨彭新185****7571</span></p>
            </div>
            <div class="r">
                <p class="kuain">
                    <a href="###" id="hong">顶</a>
                    <a href="###">荐</a>
                </p>
                <p>2016-08-15</p>
            </div>
        </div>
        <div class="textn">
            <div class="l ">
                <p>有150多亩土地，贷100万左右</p>
                <p><span>杨彭新185****7571</span></p>
            </div>
            <div class="r">
                <p class="kuain">

                    <a href="###">荐</a>
                </p>
                <p>2016-08-15</p>
            </div>
        </div>
        <div class="textn">
            <div class="l ">
                <p>有150多亩土地，贷100万左右</p>
                <p><span>杨彭新185****7571</span></p>
            </div>
            <div class="r">
                <p class="kuain">

                    <a href="###">荐</a>
                </p>
                <p>2016-08-15</p>
            </div>
        </div>
        <div class="textn">
            <div class="l ">
                <p>有150多亩土地，贷100万左右</p>
                <p><span>杨彭新185****7571</span></p>
            </div>
            <div class="r">
                <p class="kuain">

                    <a href="###">荐</a>
                </p>
                <p>2016-08-15</p>
            </div>
        </div>
        <div class="textn">
        <div class="l ">
            <p>有150多亩土地，贷100万左右</p>
            <p><span>杨彭新185****7571</span></p>
        </div>
        <div class="r">
            <p class="kuain">

                <a href="###">荐</a>
            </p>
            <p>2016-08-15</p>
        </div>
    </div>
    </div>
    <div class="table4">
        <div class="title">业务渠道<span>更多>></span></div>
        <div class="tr1">
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
            <div><img src="img/4.png" alt=""><p>民生银行</p></div>
        </div>
    </div>
    <script>
        (function(){
            //第一步：获取我们的dom元素
            var box = document.querySelector('.box');//querySelector用来更方便地从DOM选取元素，功能类似于jQuery的选择器
            var width = box.offsetWidth;//jQuery CSS 操作 - offset() 方法:offset() 方法返回或设置匹配元素相对于文档的偏移（位置）。
            //console.log(width);
            var ul = document.querySelectorAll('ul')[0];
            var lis = document.querySelector('.item');
            var points = document.querySelectorAll('.point');

            //以下三个是封装的方法，因为需要多次用到，减少代码长度
            function addTransition(){//过渡：transition 属性是一个简写属性，用于设置四个过渡属性：默认值：all 0 ease 0
                ul.style.transition = 'all .5s ease';
            };

            function addTranslateX(x){
                ul.style.transform = 'translateX('+ x +'px)';//转换：transform   translate();绕着三个轴分别位移；
            };

            function removeTransition(){
                ul.style.transition = 'none';
            };

            function setPoint(){
                var pointIndex = index;
                // console.log(pointIndex);
                for(var i=0; i<points.length; i++){
                    points[i].classList.remove('active');//HTML DOM classList 属性:classList 属性返回元素的类名，
                    //该属性用于在元素中添加，移除及切换 CSS 类。add(),contains(),item(),remove(),toggle().
                }
                if(index >= 4 ){
                    pointIndex = 1;
                }else if(index <= 0){
                    pointIndex = 3;
                }
                // console.log(points[pointIndex]);
                points[pointIndex-1].classList.add('active');
                // points[pointIndex].className = 'point active'
            }

            //第二步：添加定时器实现过渡效果。
            var index = 1;
            var timer = null;
            timer = setInterval(function(){
                index++;
                addTransition();
                addTranslateX(-index*width);//传递参数:使用"匿名函数"调用带参数的函数：
                setPoint();
            },2000);

            //第三步：在过渡完成时中添加监听事件
            ul.addEventListener('webkitTransitionEnd', function(e){//webkit考虑兼容性
                // console.log(e);
                //监听事件：element.addEventListener(event, function, useCapture);第一个参数是事件的类型 (如 "click" 或 "mousedown").
                //第二个参数是事件触发后调用的函数。第三个参数是个布尔值用于描述事件是冒泡还是捕获。该参数是可选的。

                if(index >= 4){
                    index = 1;
                    removeTransition();
                    addTranslateX(-index*width);
                    setPoint();
                }else if(index <= 0){
                    index = 3;
                    removeTransition();
                    addTranslateX(-index*width);
                    setPoint();
                }
            });

            //第四部：小圆点做动画，达到与过渡效果同步的状态。
            var start = 0;
            var end = 0;
            var step = 0;
            //touchstart事件：当手指触摸屏幕时候触发，touchmove事件：当手指在屏幕上滑动的时候连续地触发。touchend事件：当手指从屏幕上离开的时候触发。
            ul.addEventListener('touchstart', function(e){
                clearInterval(timer);
                // console.log(e);
                start = e.touches[0].clientX;
                //每个Touch对象包含的属性如下。 clientX：触摸目标在视口中的x坐标。clientY：触摸目标在视口中的y坐标。
                //identifier：标识触摸的唯一ID。pageX：触摸目标在页面中的x坐标。pageY：触摸目标在页面中的y坐标。
                //screenX：触摸目标在屏幕中的x坐标。screenY：触摸目标在屏幕中的y坐标。target：触目的DOM节点目标。

            });

            ul.addEventListener('touchmove', function(e){
                e.preventDefault();//touchmove事件：当手指在屏幕上滑动的时候连续地触发。在这个事件发生期间，调用preventDefault()事件可以阻止滚动。
                // console.log(e);
                end = e.touches[0].clientX;
                step = start -end;
                addTransition();
                addTranslateX(-index*width-step);
            });

            ul.addEventListener('touchend', function(e){
                if(Math.abs(step) > width* 1/3 && end != 0){
                    //Math.abs(x) -- 返回数字的绝对值. abs，是absolute value的缩写，中文"绝对值"     Math.abs(x);返回x的绝对值
                    //使用Math.floor和Math.random取随机整数.Math.random():获取0~1随机数  Math.floor()返回该数的整数位：
                    // Math.floor(Math.random()*number + 1)：1到number的随机整数数
                    if(step > 0){
                        index++
                    }else{
                        index--
                    }
                }
                addTransition();
                addTranslateX(-index * width);
                setPoint();
                clearInterval(timer);
                timer = setInterval(function(){
                    index++;
                    addTransition();
                    addTranslateX(-index * width);
                },2000);
                start = 0;
                end = 0;
                step = 0;
            },false);//addEventListener() 方法可以指定 "useCapture" 参数来设置传递类型：默认值为 false, 即冒泡传递，当值为 true 时, 事件使用捕获传递。
            //在 冒泡 中，内部元素的事件会先被触发，然后再触发外部元素， 在 捕获 中，外部元素的事件会先被触发，然后才会触发内部元素的事件。

        })()

    </script>
</body>
</html>